<h1 id='title'><%= @location.primary_site_name %></h1>
<br/>
<div id="location_wrapper">

  <div id="location_first_column">
    <div id="location_first_column_first_row">
      <div id="location_metadata">
        <% if @location.itinerary_order %>
          <p>Itinerary Order: <%= @location.itinerary_order %></p>
        <% end %>
        <% if @location.latitude %>
          <p>Latitude: <%= @location.latitude %></p>
        <% end %>
        <% if @location.longitude %>
          <p>Latitude: <%= @location.longitude %></p>
        <% end %>
        <% if @location.wikipedia_link %>
          <p><%= link_to 'Wikipedia', @location.wikipedia_link, target: :_blank %></p>
        <% end %>
        <% if @location.fortalezas_link %>
          <p><%= link_to 'Fortalezas.org', @location.fortalezas_link, target: :_blank %></p>
        <% end %>
        <% if @location.castillosnet_link %>
          <p ><%= link_to 'Castillos.net', @location.castillosnet_link, target: :_blank %></p>
        <% end %>
      </div>
      <div id="location_plan">
        <% if @location.images.detect{|i| i.image_category == "plan"} %>
        <img src="<%= @location.images.detect{|i| i.image_category == "plan"}.url %>"></img>
        <% else %>
        <img src="<%= asset_path 'plan_unavailable.png' %>"></img>
        <% end %>
      </div>
    </div>
    <div id="location_image_gallery_wrapper">
      <div id="location_image_gallery">
        <% if @location.a360_3D_model_embed %>
          <div class="location_image_card" id="3d_model">
            <div class="location_image_card_thumbnail">
              <img src="<%= asset_path '3d_model.png' %>" width="200px" height="auto"></img>
            </div>
          </div>
        <% end %>
        <% @location.images.select{|i| i.image_category != "plan"}.sort_by{|i| i.image_category}.each_with_index do |image, index| %>
          <div class="location_image_card" id="image_<%= index %>">
            <div class="location_image_card_thumbnail">
              <img src="<%= image.large_thumbnail_url %>" width="200px" height="auto"></img>
            </div>
            <div class="location_image_card_metadata">
              <% if image.view_direction %>
                <p>View: <%= image.view_direction %></p>
              <% end %>
              <% if image.source == "1642_watercolor" %>
                <p>1642 Watercolor</p>
              <% end %>
              <% if image.source == "Codex A" %>
                <p>Codex A</p>
              <% end %>
              <% if image.image_category == "satellite image" %>
                <p>Satellite Image</p>
              <% end %>
            </div>
          </div>
        <% end %>
      </div> <!-- image gallery -->
    </div>
  </div> <!--location first column -->

  <div id="location_second_column">
    <div id="viewer_wrapper">



    <% if @location.a360_3D_model_embed %>
      <div id="3d_model_iframe" class="openseadragon" style="display: none;">
        <%= @location.a360_3D_model_embed .html_safe %>
      </div>
    <% end %>

    <div id="openseadragon_plan" class="openseadragon" style="display: none;"></div>

    <% @location.images.select{|i| i.image_category != "plan"}.sort_by{|i| i.image_category}.each_with_index do |image, index| %>
      <div id="openseadragon_image_<%= index %>" class="openseadragon" style="display: none;"></div>
      <% if image.agol_slide_embed %>
        <div id="agol_slide_image_<%= index %>" class="openseadragon" style="display: none;">
          <%= image.agol_slide_embed .html_safe %>
        </div>
      <% end %>
    <% end %>
    <div id="below_viewer_wrapper">
      <div id="button_wrapper">
          <button type="button" class="openseadragon_button" name="image_button">IMAGE</button>
          <button type="button" class="agol_button" name="agol_button">LANDSCAPE</button>
      </div>
      <div id="current_image_metadata_wrapper">
        <div id="current_image_metadata">
          
        </div>
      </div>
    </div>
  </div>


  </div><!--location second column -->
</div> <!--location_wrapper -->
